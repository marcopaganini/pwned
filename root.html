<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Compromised password checker</title>
  </head>
  <body>
    <h1>Enter your password</h1>
    <p>
    Enter the password to be checked or a sha1 hash of your password. No logs are kept
    of these queries and the passwords entered are not saved anywhere.
    <p>
    <form>
      <div>Password or Hash: <input type="text" id="pass"></div>
      <div><input type="submit" value="Check" onclick="checkPwned(); return false"></div>
      <!-- note: return false after the function call above is needed to avoid a refresh -->
    </form>

    <p>Results:</p>
    <div id="results"></div>

    <script>
      function checkPwned() {
        var xhttp = new XMLHttpRequest();
        xhttp.open("POST", "/view/", true);

        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            var res = JSON.parse(this.responseText);
            document.getElementById("results").innerHTML = res.count + " hashes found";
          }
        };
        pass = document.getElementById("pass").value;
        xhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhttp.send("pass=" + pass);
      }
    </script>
  </body>
</html>
